# YelpCamp タスク一覧

Udemy講座「Web Developer Bootcamp（日本語版）」の進行順に沿ったタスク一覧です。

---

## フェーズ1: キャンプ場のCRUD

| # | タスク | 詳細 | 推定時間 |
|---|--------|------|----------|
| 1.1 | プロジェクト初期化 | `npm init`、`.gitignore`、`.env`作成 | 15分 |
| 1.2 | 基本パッケージインストール | express, mongoose, ejs, ejs-mate, method-override, dotenv | 10分 |
| 1.3 | ディレクトリ構成作成 | models/, views/, routes/, public/, seeds/ | 10分 |
| 1.4 | app.js基本構成 | Express初期設定、EJSエンジン設定、MongoDB接続 | 30分 |
| 1.5 | Campgroundモデル作成 | models/campground.js - スキーマ定義（title, price, description, location, image） | 20分 |
| 1.6 | シードデータ作成 | seeds/cities.js, seedHelpers.js, index.js - 日本の都市データ、ランダムキャンプ場生成 | 45分 |
| 1.7 | キャンプ場CRUD実装 | app.jsにRESTfulルーティング（index, new, create, show, edit, update, delete） | 60分 |
| 1.8 | 一覧ページ作成 | views/campgrounds/index.ejs | 20分 |
| 1.9 | 詳細ページ作成 | views/campgrounds/show.ejs | 20分 |
| 1.10 | 新規登録ページ作成 | views/campgrounds/new.ejs | 20分 |
| 1.11 | 編集ページ作成 | views/campgrounds/edit.ejs | 20分 |

---

## フェーズ2: 基本的なスタイルをあてる

| # | タスク | 詳細 | 推定時間 |
|---|--------|------|----------|
| 2.1 | ejs-mate導入 | レイアウトエンジンの設定 | 10分 |
| 2.2 | boilerplate.ejs作成 | 共通レイアウト（Bootstrap 5 CDN読込） | 30分 |
| 2.3 | navbar.ejs作成 | ナビゲーションバー（ホーム、キャンプ場、新規登録） | 20分 |
| 2.4 | footer.ejs作成 | フッター（sticky bottom） | 10分 |
| 2.5 | app.css作成 | アプリ共通スタイル（body flexbox等） | 15分 |
| 2.6 | 一覧ページスタイル修正 | index.ejsにBootstrapカード適用 | 20分 |
| 2.7 | 新規・編集フォームスタイル | Bootstrapフォームコンポーネント適用 | 20分 |
| 2.8 | 詳細ページスタイル | show.ejsにBootstrapカード・グリッド適用 | 20分 |
| 2.9 | home.ejs作成 | ランディングページ（独自レイアウト、home.css） | 30分 |

---

## フェーズ3: エラーハンドリングとバリデーション

| # | タスク | 詳細 | 推定時間 |
|---|--------|------|----------|
| 3.1 | ExpressError作成 | utils/ExpressError.js - カスタムエラークラス | 15分 |
| 3.2 | catchAsync作成 | utils/catchAsync.js - 非同期エラーキャッチラッパー | 15分 |
| 3.3 | エラーハンドリング設定 | app.jsにエラーハンドラー追加、全ルートをcatchAsyncでラップ | 20分 |
| 3.4 | error.ejs作成 | エラーページテンプレート | 15分 |
| 3.5 | Joiインストール・設定 | schemas.js - campgroundSchema定義 | 20分 |
| 3.6 | サーバーサイドバリデーション | Joiミドルウェアによるリクエスト検証 | 20分 |
| 3.7 | クライアントサイドバリデーション | validateForms.js - Bootstrapバリデーション | 15分 |

---

## フェーズ4: レビューモデルの追加

| # | タスク | 詳細 | 推定時間 |
|---|--------|------|----------|
| 4.1 | Reviewモデル作成 | models/review.js - body, rating | 15分 |
| 4.2 | CampgroundモデルにReview参照追加 | reviews: [ObjectId] | 10分 |
| 4.3 | レビュー投稿ルート | POST /campgrounds/:id/reviews | 20分 |
| 4.4 | レビュー削除ルート | DELETE /campgrounds/:id/reviews/:reviewId | 20分 |
| 4.5 | レビューフォームUI | show.ejsにレビュー投稿フォーム追加 | 20分 |
| 4.6 | レビュー一覧表示 | show.ejsにレビュー一覧・削除ボタン追加 | 20分 |
| 4.7 | レビューJoiバリデーション | schemas.js - reviewSchema定義 | 10分 |
| 4.8 | カスケード削除 | Campground削除時にReviewも一括削除（post findOneAndDelete） | 20分 |

---

## フェーズ5: リファクタとフラッシュ

| # | タスク | 詳細 | 推定時間 |
|---|--------|------|----------|
| 5.1 | Expressルーター分離 | routes/campgrounds.js, routes/reviews.js 作成 | 30分 |
| 5.2 | static files設定 | express.static でpublicディレクトリ配信 | 10分 |
| 5.3 | express-session設定 | セッションミドルウェア設定 | 20分 |
| 5.4 | connect-flash導入 | フラッシュメッセージ設定 | 10分 |
| 5.5 | flash.ejs作成 | フラッシュメッセージ表示パーシャル（success, error） | 15分 |
| 5.6 | フラッシュメッセージ追加 | CRUD操作成功時のメッセージ表示 | 20分 |

---

## フェーズ6: 認証を追加する

| # | タスク | 詳細 | 推定時間 |
|---|--------|------|----------|
| 6.1 | パッケージインストール | passport, passport-local, passport-local-mongoose | 10分 |
| 6.2 | Userモデル作成 | models/user.js - passport-local-mongooseプラグイン | 20分 |
| 6.3 | Passport設定 | app.jsにpassport初期化、serialize/deserialize | 20分 |
| 6.4 | ユーザールーター作成 | routes/users.js - register, login, logout | 15分 |
| 6.5 | ユーザー登録ページ | views/users/register.ejs | 20分 |
| 6.6 | ログインページ | views/users/login.ejs | 20分 |
| 6.7 | ログイン・ログアウト処理 | passport.authenticate, req.logout | 20分 |
| 6.8 | currentUser設定 | res.localsにcurrentUserを設定 | 10分 |
| 6.9 | ナビバー認証対応 | ログイン状態に応じた表示切替 | 15分 |
| 6.10 | isLoggedInミドルウェア | ログイン必須チェック | 15分 |
| 6.11 | returnTo機能 | ログイン後に元のページへリダイレクト | 15分 |

---

## フェーズ7: 基本的な認可を追加

| # | タスク | 詳細 | 推定時間 |
|---|--------|------|----------|
| 7.1 | Campgroundにauthor追加 | モデルにauthor（User参照）フィールド追加 | 10分 |
| 7.2 | Reviewにauthor追加 | モデルにauthor（User参照）フィールド追加 | 10分 |
| 7.3 | キャンプ場作成時にauthor設定 | req.user._idを自動設定 | 10分 |
| 7.4 | レビュー作成時にauthor設定 | req.user._idを自動設定 | 10分 |
| 7.5 | isAuthorミドルウェア | middleware.js - キャンプ場の作成者チェック | 20分 |
| 7.6 | isReviewAuthorミドルウェア | middleware.js - レビューの作成者チェック | 15分 |
| 7.7 | UI表示制御 | 作成者のみ編集・削除ボタン表示、レビュー作成者のみ削除表示 | 20分 |
| 7.8 | シードデータ更新 | seeds/index.jsにauthor追加 | 10分 |

---

## フェーズ8: コントローラーと星を使った評価

| # | タスク | 詳細 | 推定時間 |
|---|--------|------|----------|
| 8.1 | controllersディレクトリ作成 | controllers/ ディレクトリ作成 | 5分 |
| 8.2 | キャンプ場コントローラー | controllers/campgrounds.js - ルートハンドラーを分離 | 30分 |
| 8.3 | レビューコントローラー | controllers/reviews.js - ルートハンドラーを分離 | 20分 |
| 8.4 | ユーザーコントローラー | controllers/users.js - ルートハンドラーを分離 | 20分 |
| 8.5 | ルーターをコントローラーに接続 | routes/*.jsからcontrollers/*.jsを呼出 | 15分 |
| 8.6 | 星評価UI実装 | starability CSSの導入（starability-basic） | 20分 |
| 8.7 | 星評価表示 | show.ejsでレビューの星を表示（starability-result） | 15分 |
| 8.8 | stars.css作成 | 星評価用スタイルシート | 15分 |

---

## フェーズ9: 画像アップロード

| # | タスク | 詳細 | 推定時間 |
|---|--------|------|----------|
| 9.1 | パッケージインストール | cloudinary, multer, multer-storage-cloudinary | 10分 |
| 9.2 | Cloudinary設定 | cloudinary/index.js - config, storage設定 | 20分 |
| 9.3 | multerミドルウェア追加 | ルートにupload.array('image')追加 | 15分 |
| 9.4 | Campgroundモデル修正 | imagesを配列（url, filename）に変更 | 15分 |
| 9.5 | ImageSchemaのvirtual | サムネイルURL生成（/upload/w_200） | 15分 |
| 9.6 | 新規登録フォーム修正 | enctype="multipart/form-data"、file input追加 | 10分 |
| 9.7 | 編集フォーム修正 | 画像追加アップロード・画像削除チェックボックス | 25分 |
| 9.8 | 画像削除処理 | コントローラーでCloudinaryとDBから画像削除 | 25分 |

---

## フェーズ10: 地図の追加

| # | タスク | 詳細 | 推定時間 |
|---|--------|------|----------|
| 10.1 | パッケージインストール | @mapbox/mapbox-sdk | 5分 |
| 10.2 | ジオコーディング実装 | 新規登録・編集時に場所名→座標変換 | 30分 |
| 10.3 | GeoJSON対応 | CampgroundモデルにGeoJSON geometry追加 | 15分 |
| 10.4 | 詳細ページマップ | showPageMap.js - 個別キャンプ場のマーカー表示 | 30分 |
| 10.5 | show.ejsにマップ組込 | マップコンテナとスクリプト追加 | 15分 |
| 10.6 | popupMarkup virtual | マップのポップアップHTMLをvirtualプロパティで生成 | 15分 |

---

## フェーズ11: クラスターマップ

| # | タスク | 詳細 | 推定時間 |
|---|--------|------|----------|
| 11.1 | クラスターマップ実装 | clusterMap.js - 全キャンプ場のクラスター表示 | 45分 |
| 11.2 | index.ejsにマップ組込 | マップコンテナとGeoJSONデータの埋込 | 20分 |
| 11.3 | コントローラー修正 | indexでGeoJSONデータをビューに渡す | 15分 |
| 11.4 | ポップアップ実装 | クリックでキャンプ場名・リンクを表示 | 15分 |

---

## フェーズ12: スタイルの最終仕上げ

| # | タスク | 詳細 | 推定時間 |
|---|--------|------|----------|
| 12.1 | 一覧ページ最終調整 | index.ejsのカードレイアウト・画像表示改善 | 20分 |
| 12.2 | 詳細ページ最終調整 | show.ejsのカルーセル・レイアウト改善 | 25分 |
| 12.3 | フォームページ最終調整 | new.ejs, edit.ejsのUI改善 | 20分 |
| 12.4 | レスポンシブ対応 | 各ページのモバイル表示確認・調整 | 20分 |
| 12.5 | app.css最終調整 | 全体的なスタイル仕上げ | 15分 |

---

## フェーズ13: よくあるセキュリティ課題への対処

| # | タスク | 詳細 | 推定時間 |
|---|--------|------|----------|
| 13.1 | helmet導入 | CSP（Content Security Policy）設定 | 30分 |
| 13.2 | CSP許可リスト設定 | Mapbox, Cloudinary, Bootstrap等のドメイン許可 | 20分 |
| 13.3 | express-mongo-sanitize導入 | NoSQLインジェクション対策 | 10分 |
| 13.4 | sanitize-html導入 | Joiカスタムバリデーション（HTMLエスケープ） | 25分 |
| 13.5 | middleware.js整理 | バリデーション・認証・認可ミドルウェア最終整理 | 15分 |

---

## フェーズ14: デプロイ

| # | タスク | 詳細 | 推定時間 |
|---|--------|------|----------|
| 14.1 | MongoDB Atlas設定 | 本番用データベース作成・接続文字列取得 | 20分 |
| 14.2 | connect-mongo設定 | セッションストアをMongoDB Atlasに変更 | 15分 |
| 14.3 | 環境変数整理 | 本番/開発の環境変数切替（NODE_ENV） | 15分 |
| 14.4 | デプロイ先設定 | Render / Heroku / Railway 等のサービス設定 | 30分 |
| 14.5 | 環境変数設定（本番） | デプロイ先に環境変数を設定 | 15分 |
| 14.6 | シードデータ投入（本番） | 本番DBにシードデータ投入 | 10分 |
| 14.7 | 動作テスト | 全機能の手動テスト | 60分 |
| 14.8 | README作成 | プロジェクト説明、セットアップ手順 | 30分 |

---

## 推定合計工数

| フェーズ | 推定時間 |
|----------|----------|
| フェーズ1: キャンプ場のCRUD | 4時間30分 |
| フェーズ2: 基本的なスタイルをあてる | 2時間55分 |
| フェーズ3: エラーハンドリングとバリデーション | 2時間 |
| フェーズ4: レビューモデルの追加 | 2時間15分 |
| フェーズ5: リファクタとフラッシュ | 1時間45分 |
| フェーズ6: 認証を追加する | 3時間 |
| フェーズ7: 基本的な認可を追加 | 1時間45分 |
| フェーズ8: コントローラーと星を使った評価 | 2時間20分 |
| フェーズ9: 画像アップロード | 2時間15分 |
| フェーズ10: 地図の追加 | 1時間50分 |
| フェーズ11: クラスターマップ | 1時間35分 |
| フェーズ12: スタイルの最終仕上げ | 1時間40分 |
| フェーズ13: よくあるセキュリティ課題への対処 | 1時間40分 |
| フェーズ14: デプロイ | 3時間15分 |
| **合計** | **約33時間25分** |

---

## 3月上旬完了スケジュール（2/8〜3/7）

> 前提: 平日は1〜1.5時間、土日は2〜3時間の作業を想定

### Week 1: 2/8（日）〜 2/14（土）【目標: 7時間25分】

| 日付 | 曜日 | 作業内容 | 時間 |
|------|------|----------|------|
| 2/8 | 日 | フェーズ1: 1.1〜1.4（プロジェクト初期化〜app.js基本構成） | 2〜3時間 |
| 2/9 | 月 | フェーズ1: 1.5〜1.6（モデル作成・シードデータ） | 1〜1.5時間 | ☑2/9  ☑2/10
| 2/10 | 火 | フェーズ1: 1.7（キャンプ場CRUD実装） | 1〜1.5時間 |　☑2/11 ,☑2/12
| 2/11 | 水 | フェーズ1: 1.8〜1.11（ビューページ4つ作成） | 1〜1.5時間 | ☑2/11 ,☑2/12
| 2/13 | 金 | フェーズ2: 2.1〜2.5（レイアウト・ナビバー・CSS） | 1〜1.5時間 |
| 2/14 | 土 | フェーズ2: 2.6〜2.9（各ページスタイル・ホームページ） | 2〜3時間 |

### Week 2: 2/15（日）〜 2/21（土）【目標: 9時間】

| 日付 | 曜日 | 作業内容 | 時間 |
|------|------|----------|------|
| 2/15 | 日 | フェーズ3: 3.1〜3.7（エラーハンドリング・バリデーション全部） | 2〜3時間 |
| 2/16 | 月 | フェーズ4: 4.1〜4.4（Reviewモデル・ルート作成） | 1〜1.5時間 |
| 2/17 | 火 | フェーズ4: 4.5〜4.8（レビューUI・バリデーション・カスケード削除） | 1〜1.5時間 |
| 2/18 | 水 | フェーズ5: 5.1〜5.6（ルーター分離・セッション・フラッシュ） | 1.5〜2時間 |
| 2/20 | 金 | フェーズ6: 6.1〜6.6（Passport設定・ユーザー登録・ログインページ） | 1.5〜2時間 |
| 2/21 | 土 | フェーズ6: 6.7〜6.11（ログイン処理・ミドルウェア・returnTo） | 1.5〜2時間 |

### Week 3: 2/22（日）〜 2/28（土）【目標: 8時間10分】

| 日付 | 曜日 | 作業内容 | 時間 |
|------|------|----------|------|
| 2/22 | 日 | フェーズ7: 7.1〜7.8（認可・author追加・ミドルウェア） | 2〜3時間 |
| 2/23 | 月 | フェーズ8: 8.1〜8.5（コントローラー分離・ルーター接続） | 1.5〜2時間 |
| 2/24 | 火 | フェーズ8: 8.6〜8.8（星評価UI） | 1〜1.5時間 |
| 2/25 | 水 | フェーズ9: 9.1〜9.5（Cloudinary設定・モデル修正） | 1〜1.5時間 |
| 2/27 | 金 | フェーズ9: 9.6〜9.8（フォーム修正・画像削除処理） | 1〜1.5時間 |
| 2/28 | 土 | フェーズ10: 10.1〜10.6（Mapbox・ジオコーディング・マップ表示） | 2〜3時間 |

### Week 4: 3/1（日）〜 3/7（土）【目標: 8時間10分】

| 日付 | 曜日 | 作業内容 | 時間 |
|------|------|----------|------|
| 3/1 | 日 | フェーズ11: 11.1〜11.4（クラスターマップ全部） | 2〜3時間 |
| 3/2 | 月 | フェーズ12: 12.1〜12.5（スタイル最終仕上げ） | 1.5〜2時間 |
| 3/3 | 火 | フェーズ13: 13.1〜13.5（セキュリティ対策全部） | 1.5〜2時間 |
| 3/5 | 木 | フェーズ14: 14.1〜14.3（Atlas設定・環境変数整理） | 1〜1.5時間 |
| 3/6 | 金 | フェーズ14: 14.4〜14.6（デプロイ先設定・シードデータ投入） | 1〜1.5時間 |
| 3/7 | 土 | フェーズ14: 14.7〜14.8（動作テスト・README作成）🎉完了 | 2〜3時間 |

### 注意事項

- 木曜日は予備日として空けています。遅れが出たら木曜で調整してください
- Udemy動画の視聴時間は含まれていません。動画を見てから作業する場合、1.5〜2倍の時間を見込んでください
- つまずいたら無理に進めず、翌日の予備時間で復習するのがおすすめです
